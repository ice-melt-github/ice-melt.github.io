<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Python自然语言处理03 处理原始文本 | 夕兮曦兮的个人网站</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="ice-melt's Blog">
  
  <meta name="description" content="前言">
<meta name="keywords" content="Python自然语言处理,NLP">
<meta property="og:type" content="article">
<meta property="og:title" content="Python自然语言处理03 处理原始文本">
<meta property="og:url" content="https://ice-melt.github.io/2019/04/16/Python-NLP-03/index.html">
<meta property="og:site_name" content="夕兮曦兮的个人网站">
<meta property="og:description" content="前言">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-05-08T06:06:41.307Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python自然语言处理03 处理原始文本">
<meta name="twitter:description" content="前言">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  

  
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</head>
</html>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">ice-melt&#39;s Blog</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a href="/">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </a>
                    
                    <a href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>Archives</span>
                    </a>
                    
                    <a href="/about">
                        <i class="fa fa-user"></i>
                        <span>About</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        ice-melt&#39;s Blog
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        冰冻三尺 非一日之寒 积土成山 非斯须之作。
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="ice-melt" target="_blank" href="https://ice-melt.github.io/">
                            <i class="fa fa-home fa-2x"></i></a>
                    
                        <a title="Github" target="_blank" href="//github.com/ice-melt">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                        <a title="Weibo" target="_blank" href="//weibo.com/ice-melt">
                            <i class="fa fa-weibo fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-Python-NLP-03" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      Python自然语言处理03 处理原始文本
    </h1>
    <div class="post-title-bar">
      <ul>
          
        <li>
          <i class="fa fa-calendar"></i>  2019-04-16
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <p>前言<br><a id="more"></a></p>
<h3 id="3-1-从网络和硬盘上访问文本"><a href="#3-1-从网络和硬盘上访问文本" class="headerlink" title="3.1 从网络和硬盘上访问文本"></a>3.1 从网络和硬盘上访问文本</h3><h4 id="电子书"><a href="#电子书" class="headerlink" title="电子书"></a>电子书</h4><p>nltk 包含 古腾堡项目 的一小部分样本文本。<br>对其它文本感兴趣可访问:<br><a href="https://www.gutenberg.org/catalog/" target="_blank" rel="noopener">https://www.gutenberg.org/catalog/</a></p>
<p>此站点包含 25000 本免费在线书籍(ASCII 码文本文件)<br>90%的文本是英文的,但是还包括50多种其他语言的文本材料</p>
<h4 id="处理HTML"><a href="#处理HTML" class="headerlink" title="处理HTML"></a>处理HTML</h4><ul>
<li><code>nltk.clean_html(html)</code>  # 通过 html 字符串,返回原始文本</li>
</ul>
<p>更多处理 HTML 的内容,可以下载 <code>Beautiful Soup</code> 软件包<br><a href="https://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="noopener">https://www.crummy.com/software/BeautifulSoup/</a></p>
<h4 id="处理搜索引擎的结果"><a href="#处理搜索引擎的结果" class="headerlink" title="处理搜索引擎的结果"></a>处理搜索引擎的结果</h4><ul>
<li>优点:数据量大;容易使用</li>
<li>缺点:搜索方式允许的范围受到限制;搜索引擎得到的结果在异时异地不同;返回结果可能会不可预料的变化</li>
</ul>
<h4 id="处理-RSS-订阅"><a href="#处理-RSS-订阅" class="headerlink" title="处理 RSS 订阅"></a>处理 RSS 订阅</h4><p>Python 库 <code>Universal Feed Parser</code> 可以访问博客内容,</p>
<p>下载:<code>pip install feedparser</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> feedparser</span><br><span class="line"></span><br><span class="line">llog = feedparser.parse(<span class="string">"http://languagelog.ldc.upenn.edu/nll/?feed=atom"</span>)</span><br><span class="line"></span><br><span class="line">print(llog[<span class="string">'feed'</span>][<span class="string">'title'</span>])</span><br><span class="line">print(len(llog.entries))</span><br><span class="line">post = llog.entries[<span class="number">2</span>]</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"># 博客实体的属性有这些,可以打印查看</span></span><br><span class="line"><span class="string">'authors', 'author_detail', 'href', 'author', 'title', 'title_detail', 'links', </span></span><br><span class="line"><span class="string">'link', 'id', 'guidislink', 'updated', 'updated_parsed', 'published', 'published_parsed',</span></span><br><span class="line"><span class="string">'tags', 'summary', 'summary_detail', 'content', 'thr_total'</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">print(post.title)</span><br><span class="line">content = post.content[<span class="number">0</span>].value</span><br><span class="line">print(content[:<span class="number">40</span>])</span><br><span class="line"></span><br><span class="line"><span class="string">"""Output:</span></span><br><span class="line"><span class="string">Language Log</span></span><br><span class="line"><span class="string">13</span></span><br><span class="line"><span class="string">Sino-English neologisms</span></span><br><span class="line"><span class="string">&lt;p&gt;As I've mentioned before, Chinese fee</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<h4 id="读取本地文本"><a href="#读取本地文本" class="headerlink" title="读取本地文本"></a>读取本地文本</h4><p>Python 中查看当前目录<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.listdir(<span class="string">'.'</span>)</span><br></pre></td></tr></table></figure></p>
<p><code>open(filepath,&#39;rU&#39;)</code>  # r 表示”只读”,U表示”通用”,即忽略换行符公约</p>
<p>open访问NLTK中的语料库文件<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意安装语料库的位置,</span></span><br><span class="line">path = nltk.data.find(<span class="string">r"corpora\gutenberg\melville-moby_dick.txt"</span>)</span><br><span class="line">raw = open(path, <span class="string">'rU'</span>).read()</span><br></pre></td></tr></table></figure></p>
<h4 id="从PDF、MS-Word-及其他二进制格式中提取文本"><a href="#从PDF、MS-Word-及其他二进制格式中提取文本" class="headerlink" title="从PDF、MS Word 及其他二进制格式中提取文本"></a>从PDF、MS Word 及其他二进制格式中提取文本</h4><ul>
<li>ASCII 码和 HTML 文本是可读格式</li>
<li>文字以二进制格式出现,(PDF和MSWord…)只能使用专门的软件打开<ul>
<li><code>pypdf</code> 、 <code>pywin32</code> 等</li>
</ul>
</li>
</ul>
<h4 id="捕获用户输入"><a href="#捕获用户输入" class="headerlink" title="捕获用户输入"></a>捕获用户输入</h4><ul>
<li>python3 中没有 <code>raw_input</code>,直接使用 <code>input</code> 即可<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = input(<span class="string">"Enter some text:"</span>)</span><br><span class="line">print(nltk.word_tokenize(s))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="NLP-的流程"><a href="#NLP-的流程" class="headerlink" title="NLP 的流程"></a>NLP 的流程</h4><ul>
<li>处理流程:<code>HTML-&gt;ASCII-&gt;Text-&gt;Vocab</code></li>
<li>讲一个字符串分词,会产生一个(词的)链表(<code>&lt;list&gt;</code>类型)<br>,规范化和排序链表可产生其他链表<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">text = nltk.word_tokenize(s)</span><br><span class="line">words = [w.lower() <span class="keyword">for</span> w <span class="keyword">in</span> text]</span><br><span class="line">vocab = sorted(set(words))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-2-字符串-最底层的文本处理"><a href="#3-2-字符串-最底层的文本处理" class="headerlink" title="3.2 字符串:最底层的文本处理"></a>3.2 字符串:最底层的文本处理</h3><h4 id="字符串的基本操作-略"><a href="#字符串的基本操作-略" class="headerlink" title="字符串的基本操作(略)"></a>字符串的基本操作(略)</h4><h4 id="输出字符串-略"><a href="#输出字符串-略" class="headerlink" title="输出字符串(略)"></a>输出字符串(略)</h4><h4 id="访问单个字符-略"><a href="#访问单个字符-略" class="headerlink" title="访问单个字符(略)"></a>访问单个字符(略)</h4><h4 id="访问子字符串-略"><a href="#访问子字符串-略" class="headerlink" title="访问子字符串(略)"></a>访问子字符串(略)</h4><h4 id="更多的字符串操作-略-P99-表3-2"><a href="#更多的字符串操作-略-P99-表3-2" class="headerlink" title="更多的字符串操作(略) P99 表3-2"></a>更多的字符串操作(略) P99 表3-2</h4><h4 id="链表与字符串的差异-略"><a href="#链表与字符串的差异-略" class="headerlink" title="链表与字符串的差异(略)"></a>链表与字符串的差异(略)</h4><h3 id="3-3-使用-Unicode-进行文字处理-略"><a href="#3-3-使用-Unicode-进行文字处理-略" class="headerlink" title="3.3 使用 Unicode 进行文字处理(略)"></a>3.3 使用 Unicode 进行文字处理(略)</h3><h4 id="什么是-Unicode-略-P101-略"><a href="#什么是-Unicode-略-P101-略" class="headerlink" title="什么是 Unicode (略) P101(略)"></a>什么是 Unicode (略) P101(略)</h4><h4 id="从文件中提取已编码文件"><a href="#从文件中提取已编码文件" class="headerlink" title="从文件中提取已编码文件"></a>从文件中提取已编码文件</h4><p>Python 特定的编码 <code>unicode_escape</code> 是一个虚拟编码<br>它把所有非 <code>ASCII</code> 字符转换成 <code>\uXXXX</code> 形式<br>编码点在 0~127 的范围以外但低于 256 的,使用两位数字的形式 <code>\xXX</code> 表示</p>
<p><code>str.encode(&#39;unicode_escape&#39;)</code></p>
<p>Python 可以使用 <code>ord()</code> 查找字符的整数序列<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ord(<span class="string">'a'</span>) <span class="comment"># =97</span></span><br><span class="line">print(<span class="string">u'\u0061'</span>)  <span class="comment"># 输出 a , 因为97的十六进制四位数是 0061</span></span><br></pre></td></tr></table></figure></p>
<p>Python 的print语句假设Unicode 字符的默认编码是 ASCII 码,<br>不在 ASCII 码范围之内,除非指定编码否则不能输出</p>
<p><code>repr(str) # 输出 UTF-8 转义序列</code></p>
<h4 id="在-Python-中使用本地编码-略"><a href="#在-Python-中使用本地编码-略" class="headerlink" title="在 Python 中使用本地编码(略)"></a>在 Python 中使用本地编码(略)</h4><h3 id="3-4-使用正则表达式检测词组搭配"><a href="#3-4-使用正则表达式检测词组搭配" class="headerlink" title="3.4 使用正则表达式检测词组搭配"></a>3.4 使用正则表达式检测词组搭配</h3><h4 id="使用基本的元字符-略"><a href="#使用基本的元字符-略" class="headerlink" title="使用基本的元字符(略)"></a>使用基本的元字符(略)</h4><p><code>$</code> <code>^</code> <code>?</code></p>
<h4 id="范围与闭包-略-P109-表3-3"><a href="#范围与闭包-略-P109-表3-3" class="headerlink" title="范围与闭包(略) P109 表3-3"></a>范围与闭包(略) P109 表3-3</h4><ul>
<li><code>[]</code> </li>
<li><code>+</code> 一个或多个实例</li>
<li><code>*</code> 0个或多个实例</li>
<li><code>\</code> 转义成普通字符</li>
<li><code>{}</code> 重复次数</li>
<li><code>()</code> 操作符范围</li>
<li><code>|</code> 管道(析取)<h3 id="3-5-正则表达式的有益应用"><a href="#3-5-正则表达式的有益应用" class="headerlink" title="3.5 正则表达式的有益应用"></a>3.5 正则表达式的有益应用</h3>正则表达式作用:</li>
<li>检查是否匹配单词</li>
<li>从词汇中提取特征</li>
<li>以特殊的方式修改词<h4 id="提取字符块"><a href="#提取字符块" class="headerlink" title="提取字符块"></a>提取字符块</h4><code>[int(n) for n in re.findall(r&#39;\d+&#39;, &#39;2009-12-31&#39;)]</code><h4 id="在字符快上做更多事情"><a href="#在字符快上做更多事情" class="headerlink" title="在字符快上做更多事情"></a>在字符快上做更多事情</h4></li>
<li><p>去除元音</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line"></span><br><span class="line">regexp = <span class="string">r'^[AEIOUaeiou]+|[AEIOUaeiou]+$|[^AEIOUaeiou]'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compress</span><span class="params">(word)</span>:</span></span><br><span class="line">	pieces = re.findall(regexp, word)</span><br><span class="line">	<span class="keyword">return</span> <span class="string">''</span>.join(pieces)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">english_udhr = nltk.corpus.udhr.words(<span class="string">'English-Latin1'</span>)</span><br><span class="line">print(nltk.tokenwrap([compress(w) <span class="keyword">for</span> w <span class="keyword">in</span> english_udhr[:<span class="number">75</span>]]))</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Unvrsl Dclrtn of Hmn Rghts Prmble Whrs rcgntn of the inhrnt dgnty and</span></span><br><span class="line"><span class="string">of the eql and inlnble rghts of all mmbrs of the hmn fmly is the fndtn</span></span><br><span class="line"><span class="string">of frdm , jstce and pce in the wrld , Whrs dsrgrd and cntmpt fr hmn</span></span><br><span class="line"><span class="string">rghts hve rsltd in brbrs acts whch hve outrgd the cnscnce of mnknd ,</span></span><br><span class="line"><span class="string">and the advnt of a wrld in whch hmn bngs shll enjy frdm of spch and</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化条件频率分布</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rotokas_words = nltk.corpus.toolbox.words(<span class="string">'rotokas.dic'</span>)</span><br><span class="line">cvs = [cv <span class="keyword">for</span> w <span class="keyword">in</span> rotokas_words <span class="keyword">for</span> cv <span class="keyword">in</span> re.findall(<span class="string">r'[ptksvr][aeiou]'</span>, w)]</span><br><span class="line">cfd = nltk.ConditionalFreqDist(cvs)</span><br><span class="line">cfd.tabulate()</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    a   e   i   o   u </span></span><br><span class="line"><span class="string">k 418 148  94 420 173 </span></span><br><span class="line"><span class="string">p  83  31 105  34  51 </span></span><br><span class="line"><span class="string">r 187  63  84  89  79 </span></span><br><span class="line"><span class="string">s   0   0 100   2   1 </span></span><br><span class="line"><span class="string">t  47   8   0 148  37 </span></span><br><span class="line"><span class="string">v  93  27 105  48  49 </span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查上表中数字背后对应的词汇</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cv_word_pairs = [(cv, w) <span class="keyword">for</span> w <span class="keyword">in</span> rotokas_words <span class="keyword">for</span> cv <span class="keyword">in</span> re.findall(<span class="string">r'[ptksvr][aeiou]'</span>, w)]</span><br><span class="line">cv_index = nltk.Index(cv_word_pairs)</span><br><span class="line">print(cv_index[<span class="string">'su'</span>])</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">['kasuari']</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="查找词干"><a href="#查找词干" class="headerlink" title="查找词干"></a>查找词干</h4><ul>
<li><p>方法1:直接去掉任何看起来像后缀的字符</p>
<ul>
<li><p>endswith</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> suffix <span class="keyword">in</span> [<span class="string">'ing'</span>, <span class="string">'ly'</span>, <span class="string">'ed'</span>, <span class="string">'ious'</span>, <span class="string">'ies'</span>, <span class="string">'ive'</span>, <span class="string">'es'</span>, <span class="string">'s'</span>, <span class="string">'ment'</span>]:</span><br><span class="line">	<span class="keyword">if</span> word.endswith(suffix):</span><br><span class="line">		<span class="keyword">return</span> word[:-len(suffix)]</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>re.findall(r&#39;^.*(ing|ly|ed|ious|ies|ive|es|s|ment)$&#39;, &#39;processing&#39;)</code>        # [‘ing’]</p>
</li>
<li><code>re.findall(r&#39;^.*(?:ing|ly|ed|ious|ies|ive|es|s|ment)$&#39;, &#39;processing&#39;)</code>    # [‘processing’]</li>
<li><code>re.findall(r&#39;^(.*)(ing|ly|ed|ious|ies|ive|es|s|ment)$&#39;, &#39;processing&#39;)</code>    # [(‘process’, ‘ing’)]</li>
<li><code>re.findall(r&#39;^(.*)(ing|ly|ed|ious|ies|ive|es|s|ment)$&#39;, &#39;processes&#39;)</code>    # [(‘processe’, ‘s’)] *贪婪的</li>
<li><code>re.findall(r&#39;^(.*?)(ing|ly|ed|ious|ies|ive|es|s|ment)$&#39;, &#39;processes&#39;)</code>    # [(‘process’, ‘es’)] *?非贪婪的</li>
<li><code>re.findall(r&#39;^(.*?)(ing|ly|ed|ious|ies|ive|es|s|ment)?$&#39;, &#39;language&#39;)</code>    # [(‘language’, ‘’)] 空后缀</li>
</ul>
</li>
</ul>
<h4 id="搜索已分词文本"><a href="#搜索已分词文本" class="headerlink" title="搜索已分词文本"></a>搜索已分词文本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> gutenberg,nps_chart</span><br><span class="line">moby = nltk.Text(gutenberg.words(<span class="string">'melville-moby_dick.txt'</span>))</span><br><span class="line">moby.findall(<span class="string">r'&lt;a&gt;(&lt;.*&gt;)&lt;man&gt;'</span>)</span><br><span class="line"></span><br><span class="line">chat = nltk.Text(nps_chat.words())</span><br><span class="line">chat.findall(<span class="string">r"&lt;.*&gt;&lt;.*&gt;&lt;bro&gt;"</span>)</span><br><span class="line">chat.findall(<span class="string">r"&lt;l.*&gt;&#123;3,&#125;"</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>搜索 “x and other ys”发现上位词<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> brown</span><br><span class="line">hobbies_learned = nltk.Text(brown.words(categoriec=[<span class="string">'hobbies'</span>,<span class="string">'learned'</span>]))</span><br><span class="line">hobbies_learned.findall(<span class="string">r'&lt;\w*&gt;&lt;and&gt;&lt;other&gt;&lt;\w*s&gt;'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-6-规范化文本"><a href="#3-6-规范化文本" class="headerlink" title="3.6 规范化文本"></a>3.6 规范化文本</h3><p>数据准备<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">raw = <span class="string">"""DENNIS:Listen,strange women lying in ponds distributing swords</span></span><br><span class="line"><span class="string">is no basis for a system of goverment. Supreme executive pover derives from </span></span><br><span class="line"><span class="string">a mandate from the masses,not from some farcical aquatic ceremony."""</span></span><br><span class="line">tokens = nltk.word_tokenize(raw)</span><br></pre></td></tr></table></figure></p>
<h4 id="词干提取器"><a href="#词干提取器" class="headerlink" title="词干提取器"></a>词干提取器</h4><ul>
<li><p>Porter</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">porter = nltk.PorterStemmer()</span><br><span class="line">[porter.stem(t) <span class="keyword">for</span> t <span class="keyword">in</span> tokens]</span><br></pre></td></tr></table></figure>
</li>
<li><p>Lancaster</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lancaster = nltk.LancasterStemmer()</span><br><span class="line">[lancaster.stem(t) <span class="keyword">for</span> t <span class="keyword">in</span> tokens]</span><br></pre></td></tr></table></figure>
</li>
<li><p>IndexedText()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexedText</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,stemmer,text)</span>:</span></span><br><span class="line">        self._text = text</span><br><span class="line">        self._stemmer = stemmer</span><br><span class="line">        self._index = nltk.Index((self._stem(word),i)</span><br><span class="line">                                <span class="keyword">for</span> (i,word) <span class="keyword">in</span> enumerate(text))</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">concordance</span><span class="params">(self,word,width=<span class="number">40</span>)</span>:</span></span><br><span class="line">        key = self._stem(word)</span><br><span class="line">        wc = width/<span class="number">4</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self._index[key]:</span><br><span class="line">            lcontext = <span class="string">' '</span>.join(self._text[i-wc:i])</span><br><span class="line">            rcontext = <span class="string">' '</span>.join(self._text[i:i+wc])</span><br><span class="line">            ldisplay = <span class="string">'%*s'</span> % (width, lcontext[-width:])</span><br><span class="line">            rdisplay = <span class="string">'%-*s'</span> % (width, rcontext[:width])</span><br><span class="line">            print(ldisplay,rdisplay)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_stem</span><span class="params">(self,word)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._stemmer.stem(word).lower()</span><br><span class="line"></span><br><span class="line">porter = nltk.PorterStemmer()</span><br><span class="line">grail = nltk.corpus.webtext.words(<span class="string">'grail.txt'</span>)</span><br><span class="line">text = Indexedtext(porter,grail)</span><br><span class="line">text.concordance(<span class="string">'lie'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="词性归并"><a href="#词性归并" class="headerlink" title="词性归并"></a>词性归并</h4><ul>
<li><p>women —&gt; woman(没有处理lying)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wnl = nltk.WordNetLemmatizer()</span><br><span class="line">[wnl.lemmatize(t) <span class="keyword">for</span> t <span class="keyword">in</span> tokens]</span><br></pre></td></tr></table></figure>
</li>
<li><p>识别非标准词（数字，缩写，日期及任何此类标识符到一个特殊到词汇到映射）</p>
<blockquote>
<p>eg:<br>每个十进制数可映射到一个单独到标识符 0.0 上<br>每个首字母缩写映射为 AAA<br>[优点]词汇量变小，提高语言建模任务到准确性</p>
</blockquote>
</li>
</ul>
<h3 id="3-7-用正则表达式为文本分词"><a href="#3-7-用正则表达式为文本分词" class="headerlink" title="3.7 用正则表达式为文本分词"></a>3.7 用正则表达式为文本分词</h3><h4 id="分词到简单方法"><a href="#分词到简单方法" class="headerlink" title="分词到简单方法"></a>分词到简单方法</h4><ul>
<li>空格分词 <code>raw.split()</code></li>
<li>空格分词 <code>re.split(r&#39; &#39;,raw)</code></li>
<li>空白，制表符，换行符分词 <code>re.split(r&#39;[ \t\n]+&#39;,raw)</code></li>
<li>空字符分词 <code>re.split(r&#39;\s+&#39;,raw)</code></li>
<li>使用 Python 的字符类 “\w”([a-zA-Z0-9]), “\W”([all 字母，数字，下划线]) </li>
<li>无空字符串 <code>re.findall(r&#39;\w+&#39;,raw)</code></li>
<li><code>re.findall(r&#39;\w+(?:[-&#39;]\w+)*|&#39;|[-.(]+|\S\w*)</code></li>
</ul>
<p>正则表达式符号 表3-4</p>
<h4 id="NLTK的正则表达式分词器"><a href="#NLTK的正则表达式分词器" class="headerlink" title="NLTK的正则表达式分词器"></a>NLTK的正则表达式分词器</h4><p><code>nltk.regexp_tokenize()</code> (与 <code>re.findall()</code> 类似)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">'That U.S.A poster-print costs $12.40 ...'</span></span><br><span class="line">pattern = <span class="string">r'''(?x)  # set flag to allow verbose regexps</span></span><br><span class="line"><span class="string">    ([A-Z\.])+      # abbreviations, e.g. U.S.A</span></span><br><span class="line"><span class="string">    | \w+(-\w+)*    # words with optional internal hyphens</span></span><br><span class="line"><span class="string">    | \$?\d+(\.\d+)?%?  # currency and percentages, e.g. $12.40, 82%</span></span><br><span class="line"><span class="string">    | \.\.\.        # ellipsis</span></span><br><span class="line"><span class="string">    | [][.,;"'?():-_`]  # these are separate tokens</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">nltk.regexp_tokenize(text,pattern)</span><br></pre></td></tr></table></figure>
<p>使用 verbose 标志时，可以不再使用 ‘ ‘ 来匹配空格字符,而用 ‘\s’ 代替</p>
<p>regexp_tokenize() 函数有一个可选的 gaps 参数，设置 True,正则表达式指定标识符的距离</p>
<blockquote>
<p>[注意:]使用 set(tokens).difference(wordlist),通过比较分词结果与一个词表，<br>然后报告任何没有在词表出现的标识符，来评估一个分词器</p>
</blockquote>
<h4 id="分词的进一步任务"><a href="#分词的进一步任务" class="headerlink" title="分词的进一步任务"></a>分词的进一步任务</h4><ul>
<li>没有单一的解决方案能在所有领域都行之有效</li>
<li>必须根据应用领域都需要决定哪些是标识符</li>
<li>可以让分词器都输出结果与高品质都标注进行比较<ul>
<li><code>nltk.corpus.treebank_raw.raw()  # &lt;华尔街日报&gt;原始文本</code></li>
<li><code>nltk.corpus.reebank.words()  # 分好词都版本</code></li>
</ul>
</li>
<li>缩写都问题，e.g. “didn’t”<ul>
<li>可规范化为两个独立都形式 “did” 和 “n’t”</li>
<li>可查表完成</li>
</ul>
</li>
</ul>
<h3 id="3-8-分割"><a href="#3-8-分割" class="headerlink" title="3.8 分割"></a>3.8 分割</h3><h4 id="断句"><a href="#断句" class="headerlink" title="断句"></a>断句</h4><ul>
<li>NLTK Punkt 句子分割器</li>
<li><h4 id="分词"><a href="#分词" class="headerlink" title="分词"></a>分词</h4></li>
<li><p>词边界无可视表示:</p>
<p>  e.g.  爱国人(ai4 “love” [verb],guo2 “country”,ren2 “person”)</p>
<ul>
<li>“爱国/人”,”country-loving person”</li>
<li>“爱/国人”,”love country-person”</li>
</ul>
</li>
<li><p>给每个字符标注一个布尔值,来指示此字符后面是否有一个分词标志(详见第7章 “分块”)</p>
<p>  e.g. 3-2.  <code>P(123)</code><br>  表示方法(其中一种):<br>  <code>a.do you see the kitty</code><br>  <code>b.see the doggy</code><br>  <code>c.dou you like the kitty</code><br>  <code>d.like the doggy</code><br>  去除词边界的文本   </p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="string">"doyouseethekittyseethedoggydoyoulikethekittylikethedoggy"</span></span><br><span class="line">seg1 = <span class="string">"0000000000000001000000000010000000000000000100000000000"</span></span><br><span class="line">seg2 = <span class="string">"0100100100100001001001000010100100010010000100010010000"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">segment</span><span class="params">(t, segs)</span>:</span></span><br><span class="line">    words = []</span><br><span class="line">    last = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(segs)):</span><br><span class="line">        <span class="keyword">if</span> segs[i] == <span class="string">'1'</span>:</span><br><span class="line">        	words.append(t[last:i + <span class="number">1</span>])</span><br><span class="line">        	last = i + <span class="number">1</span></span><br><span class="line">    words.append(t[last:])</span><br><span class="line">    <span class="keyword">return</span> words</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s1, s2 = segment(text, seg1), segment(text, seg2)</span><br><span class="line">print(s1)</span><br><span class="line">print(s2)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">['doyouseethekitty', 'seethedoggy', 'doyoulikethekitty', 'likethedoggy'] </span></span><br><span class="line"><span class="string">['do', 'you', 'see', 'the', 'kitty', 'see', 'the', 'doggy', 'do', 'you', 'like', 'the', 'kitty', 'like', 'the', 'doggy']</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<p>  标注后,分词任务变成一个搜索问题</p>
</li>
<li><p>给定一个合适词典,可以由词典中的词的序列来重构原文本.定义<strong>目标函数</strong>,<strong>评分函数</strong>:基于词典的大小和从词典中重构原文本所需的信息量尽量优化它的值(<code>Brent &amp; Cart-wright(1995)</code>)<br>  分词质量得分越小越好<br>  e.g. 3-3. <code>P(3-3)</code>  </p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">seg3 = <span class="string">"0000100100000011001000000110000100010000001100010000001"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算存储词典和重构原文本的成本</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate</span><span class="params">(t, segs)</span>:</span></span><br><span class="line">	words = segment(t, segs)</span><br><span class="line">	text_size = len(words)</span><br><span class="line">	lexicon_size = len(<span class="string">' '</span>.join(list(set(words))))</span><br><span class="line">	<span class="keyword">return</span> text_size + lexicon_size</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s3 = segment(text, seg3)</span><br><span class="line">print(s3)</span><br><span class="line">e3 = evaluate(text, seg3)</span><br><span class="line">e2 = evaluate(text, seg2)</span><br><span class="line">e1 = evaluate(text, seg1)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">['doyou', 'see', 'thekitt', 'y', 'see', 'thedogg', 'y', 'doyou', 'like', 'thekitt', 'y', 'like', 'thedogg', 'y']</span></span><br><span class="line"><span class="string">46</span></span><br><span class="line"><span class="string">47</span></span><br><span class="line"><span class="string">63</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>寻找最大化目标函数值 0 和 1 的模式(数据中没有足够的证据进一步分割的话,得到的词也算最好的分词)</p>
<p>  e.g. 3-4. <code>P(125)</code> 模拟退火算法的非确定性搜索(随机扰动0和1,与温度成正比,温度会随迭代降低,扰动边界会减少<code>why?</code>)</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flip</span><span class="params">(segs, pos)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> segs[:pos] + str(<span class="number">1</span> - int(segs[pos])) + segs[pos + <span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flip_n</span><span class="params">(segs, n)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">		segs = flip(segs, randint(<span class="number">0</span>, len(segs) - <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> segs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">anneal</span><span class="params">(txt, segs, iterations, cooling_rate)</span>:</span></span><br><span class="line">	temperature = float(len(segs))</span><br><span class="line">	<span class="keyword">while</span> temperature &gt; <span class="number">0.5</span>:</span><br><span class="line">		best_segs, best = segs, evaluate(txt, segs)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(iterations):</span><br><span class="line">			guess = flip_n(segs, int(round(temperature)))</span><br><span class="line">			score = evaluate(txt, guess)</span><br><span class="line">			<span class="keyword">if</span> score &lt; best:</span><br><span class="line">				best, best_segs = score, guess</span><br><span class="line">		score, segs = best, best_segs</span><br><span class="line">		temperature = temperature / cooling_rate</span><br><span class="line">		print(evaluate(txt, segs), segment(txt, segs))</span><br><span class="line">	print()</span><br><span class="line">	<span class="keyword">return</span> segs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">anneal(text, seg1, <span class="number">5000</span>, <span class="number">1.2</span>)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">63 ['doyouseethekitty', 'seethedoggy', 'doyoulikethekitty', 'likethedoggy']</span></span><br><span class="line"><span class="string">60 ['doyo', 'useet', 'hekitty', 'seethed', 'oggy', 'doyouliket', 'hekitty', 'likethed', 'oggy']</span></span><br><span class="line"><span class="string">59 ['doyo', 'useet', 'hekitty', 'seethed', 'oggy', 'doyo', 'uliket', 'hekitty', 'lik', 'ethed', 'oggy']</span></span><br><span class="line"><span class="string">54 ['doyo', 'usee', 't', 'hekitty', 'se', 'ethedoggy', 'doyo', 'ulike', 't', 'hekitty', 'lik', 'ethedoggy']</span></span><br><span class="line"><span class="string">54 ['doyo', 'usee', 't', 'hekitty', 'se', 'ethedoggy', 'doyo', 'ulike', 't', 'hekitty', 'lik', 'ethedoggy']</span></span><br><span class="line"><span class="string">52 ['doyo', 'useet', 'hekitty', 'se', 'ethedoggy', 'doyo', 'uliket', 'hekitty', 'lik', 'ethedoggy']</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>有足够数据,就可能以一个合理的准确度自动将文本分割成词汇(可用于为词没有任何视觉表示的书写系统分词).</p>
<h3 id="3-9-格式化-从链表到字符串"><a href="#3-9-格式化-从链表到字符串" class="headerlink" title="3.9 格式化:从链表到字符串"></a>3.9 格式化:从链表到字符串</h3><h4 id="从链表到字符串-略"><a href="#从链表到字符串-略" class="headerlink" title="从链表到字符串(略)"></a>从链表到字符串(略)</h4><p><code>&#39;&#39;.join(list)</code></p>
<h4 id="字符串与格式-略"><a href="#字符串与格式-略" class="headerlink" title="字符串与格式(略)"></a>字符串与格式(略)</h4><p><code>%s %d</code><strong>转换说明符</strong></p>
</li>
</ul>
<h4 id="排列"><a href="#排列" class="headerlink" title="排列"></a>排列</h4><p>几点注意说明:</p>
<ul>
<li>格式化字符串可以指定宽度,eg:<code>%6s</code>,<code>%5d</code>,默认右对齐</li>
<li>可以指定左对齐,eg:<code>&#39;%-6s&#39; % &#39;dog&#39;  # &#39;dog</code></li>
<li>可以用变量指定宽度,eg:<code>&#39;%-*s&#39; % (width, &#39;dog&#39;)  # &#39;dog</code></li>
<li>%的输出,eg:<code>&#39;%2.4f%%&#39; % 100 * count / total  # 34.1867%</code><h4 id="将结果写入文件"><a href="#将结果写入文件" class="headerlink" title="将结果写入文件"></a>将结果写入文件</h4>几点经验</li>
<li>将总词数写入文件</li>
<li>避免文件名中包含空格字符</li>
<li>避免除了大小写不同其他都相同的文件名称<h4 id="文本换行"><a href="#文本换行" class="headerlink" title="文本换行"></a>文本换行</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> textwrap <span class="keyword">import</span> fill</span><br><span class="line"></span><br><span class="line">saying = [<span class="string">'After'</span>, <span class="string">'all'</span>, <span class="string">'is'</span>, <span class="string">'said'</span>, <span class="string">'and'</span>, <span class="string">'done'</span>, <span class="string">','</span>, <span class="string">'more'</span>, <span class="string">'is'</span>, <span class="string">'said'</span>, <span class="string">'than'</span>, <span class="string">'down'</span>, <span class="string">'.'</span>]</span><br><span class="line">format = <span class="string">'%s (%d),'</span></span><br><span class="line">pieces = [format % (word, len(word)) <span class="keyword">for</span> word <span class="keyword">in</span> saying]</span><br><span class="line">output = <span class="string">' '</span>.join(pieces)</span><br><span class="line">print(output)</span><br><span class="line">wrapped = fill(output)</span><br><span class="line">print(wrapped)</span><br></pre></td></tr></table></figure></li>
</ul>

            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2019年05月08日 14:06</p>
        <p>原始链接： <a class="post-url" href="/2019/04/16/Python-NLP-03/" title="Python自然语言处理03 处理原始文本">https://ice-melt.github.io/2019/04/16/Python-NLP-03/</a></p>
        <footer>
            <a href="https://ice-melt.github.io">
                <img src="/images/logo.png" alt="ice-melt">
                ice-melt
            </a>
        </footer>
    </div>
</div>

      
        
            
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;">赏</a>
</div>

<div id="reward" class="post-modal reward-lay">
    <a class="close" href="javascript:;" id="reward-close">×</a>
    <span class="reward-title">
        <i class="icon icon-quote-left"></i>
        您的支持是我原创的动力
        <i class="icon icon-quote-right"></i>
    </span>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/images/wechat_code.jpg" alt="打赏二维码">
        </div>
        <div class="reward-select">
            
            <label class="reward-select-item checked" data-id="wechat" data-wechat="/images/wechat_code.jpg">
                <img class="reward-select-item-wechat" src="/images/wechat.png" alt="微信">
            </label>
            
            
            <label class="reward-select-item" data-id="alipay" data-alipay="/images/alipay_code.jpg">
                <img class="reward-select-item-alipay" src="/images/alipay.png" alt="支付宝">
            </label>
            
        </div>
    </div>
</div>


        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ice-melt.github.io/2019/04/16/Python-NLP-03/&title=《Python自然语言处理03 处理原始文本》 — 夕兮曦兮的个人网站&pic=https://ice-melt.github.ioimages/logo.png" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ice-melt.github.io/2019/04/16/Python-NLP-03/&title=《Python自然语言处理03 处理原始文本》 — 夕兮曦兮的个人网站&source=前言" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ice-melt.github.io/2019/04/16/Python-NLP-03/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Python自然语言处理03 处理原始文本》 — 夕兮曦兮的个人网站&url=https://ice-melt.github.io/2019/04/16/Python-NLP-03/&via=https://ice-melt.github.io" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ice-melt.github.io/2019/04/16/Python-NLP-03/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://ice-melt.github.io/2019/04/16/Python-NLP-03/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/Python自然语言处理/" class="color3">Python自然语言处理</a>
      
    <a href="/tags/NLP/" class="color4">NLP</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-1-从网络和硬盘上访问文本"><span class="post-toc-text">3.1 从网络和硬盘上访问文本</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#电子书"><span class="post-toc-text">电子书</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#处理HTML"><span class="post-toc-text">处理HTML</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#处理搜索引擎的结果"><span class="post-toc-text">处理搜索引擎的结果</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#处理-RSS-订阅"><span class="post-toc-text">处理 RSS 订阅</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#读取本地文本"><span class="post-toc-text">读取本地文本</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#从PDF、MS-Word-及其他二进制格式中提取文本"><span class="post-toc-text">从PDF、MS Word 及其他二进制格式中提取文本</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#捕获用户输入"><span class="post-toc-text">捕获用户输入</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#NLP-的流程"><span class="post-toc-text">NLP 的流程</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-2-字符串-最底层的文本处理"><span class="post-toc-text">3.2 字符串:最底层的文本处理</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#字符串的基本操作-略"><span class="post-toc-text">字符串的基本操作(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#输出字符串-略"><span class="post-toc-text">输出字符串(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#访问单个字符-略"><span class="post-toc-text">访问单个字符(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#访问子字符串-略"><span class="post-toc-text">访问子字符串(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#更多的字符串操作-略-P99-表3-2"><span class="post-toc-text">更多的字符串操作(略) P99 表3-2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#链表与字符串的差异-略"><span class="post-toc-text">链表与字符串的差异(略)</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-3-使用-Unicode-进行文字处理-略"><span class="post-toc-text">3.3 使用 Unicode 进行文字处理(略)</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#什么是-Unicode-略-P101-略"><span class="post-toc-text">什么是 Unicode (略) P101(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#从文件中提取已编码文件"><span class="post-toc-text">从文件中提取已编码文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#在-Python-中使用本地编码-略"><span class="post-toc-text">在 Python 中使用本地编码(略)</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-4-使用正则表达式检测词组搭配"><span class="post-toc-text">3.4 使用正则表达式检测词组搭配</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用基本的元字符-略"><span class="post-toc-text">使用基本的元字符(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#范围与闭包-略-P109-表3-3"><span class="post-toc-text">范围与闭包(略) P109 表3-3</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-5-正则表达式的有益应用"><span class="post-toc-text">3.5 正则表达式的有益应用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#提取字符块"><span class="post-toc-text">提取字符块</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#在字符快上做更多事情"><span class="post-toc-text">在字符快上做更多事情</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#查找词干"><span class="post-toc-text">查找词干</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#搜索已分词文本"><span class="post-toc-text">搜索已分词文本</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-6-规范化文本"><span class="post-toc-text">3.6 规范化文本</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#词干提取器"><span class="post-toc-text">词干提取器</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#词性归并"><span class="post-toc-text">词性归并</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-7-用正则表达式为文本分词"><span class="post-toc-text">3.7 用正则表达式为文本分词</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#分词到简单方法"><span class="post-toc-text">分词到简单方法</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#NLTK的正则表达式分词器"><span class="post-toc-text">NLTK的正则表达式分词器</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#分词的进一步任务"><span class="post-toc-text">分词的进一步任务</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-8-分割"><span class="post-toc-text">3.8 分割</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#断句"><span class="post-toc-text">断句</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#分词"><span class="post-toc-text">分词</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-9-格式化-从链表到字符串"><span class="post-toc-text">3.9 格式化:从链表到字符串</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#从链表到字符串-略"><span class="post-toc-text">从链表到字符串(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#字符串与格式-略"><span class="post-toc-text">字符串与格式(略)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#排列"><span class="post-toc-text">排列</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#将结果写入文件"><span class="post-toc-text">将结果写入文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#文本换行"><span class="post-toc-text">文本换行</span></a></li></ol></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2019/04/17/Python-NLP-04/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          Python自然语言处理04 编写结构化程序
        
      </span>
    </a>
  
  
    <a href="/2019/04/12/Python-NLP-02/" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">Python自然语言处理02 获得文本语料和词汇资源</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>



    
        <div id="SOHUCS" sid="Python-NLP-03"></div>
<script type="text/javascript">
    (function(){
        var appid = 'cytRPCpOX';
        var conf = 'prod_1e65dc7b851067d2e5fa952e667c6b16';
        var width = window.innerWidth || document.documentElement.clientWidth;
        if (width < 960) {
            window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2019 ice-melt<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "https://ice-melt.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/NLP/" style="font-size: 20px;">NLP</a> <a href="/tags/Python自然语言处理/" style="font-size: 20px;">Python自然语言处理</a> <a href="/tags/人工智能/" style="font-size: 10px;">人工智能</a> <a href="/tags/建站/" style="font-size: 10px;">建站</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a href="/">
                    <i class="fa fa-home"></i><span>Home</span>
                </a>
            </li>
            
            <li>
                <a href="/archives">
                    <i class="fa fa-archive"></i><span>Archives</span>
                </a>
            </li>
            
            <li>
                <a href="/about">
                    <i class="fa fa-user"></i><span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/NLP/" style="font-size: 20px;">NLP</a> <a href="/tags/Python自然语言处理/" style="font-size: 20px;">Python自然语言处理</a> <a href="/tags/人工智能/" style="font-size: 10px;">人工智能</a> <a href="/tags/建站/" style="font-size: 10px;">建站</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>


  <script src="/js/pop-img.js"></script>
  <script>
     $(".article-entry p img").popImg();
  </script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>